/*!
 * @license :@maticnetwork/maticjs - V3.5.0 - 16/09/2022
 * https://github.com/maticnetwork/matic.js
 * Copyright (c) 2022 @polygon; Licensed MIT
 */
module.exports=function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=7)}([function(t,e){t.exports=require("ethereumjs-util")},function(t,e,r){
/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
var n=r(5),o=n.Buffer;function i(t,e){for(var r in t)e[r]=t[r]}function a(t,e,r){return o(t,e,r)}o.from&&o.alloc&&o.allocUnsafe&&o.allocUnsafeSlow?t.exports=n:(i(n,e),e.Buffer=a),a.prototype=Object.create(o.prototype),i(o,a),a.from=function(t,e,r){if("number"==typeof t)throw new TypeError("Argument must not be a number");return o(t,e,r)},a.alloc=function(t,e,r){if("number"!=typeof t)throw new TypeError("Argument must be a number");var n=o(t);return void 0!==e?"string"==typeof r?n.fill(e,r):n.fill(e):n.fill(0),n},a.allocUnsafe=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return o(t)},a.allocUnsafeSlow=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return n.SlowBuffer(t)}},function(t,e){t.exports=require("@ethereumjs/common")},function(t,e){t.exports=require("merkle-patricia-tree")},function(t,e){t.exports=require("@ethereumjs/block")},function(t,e){t.exports=require("buffer")},function(t,e){t.exports=require("node-fetch")},function(t,e,r){"use strict";r.r(e),r.d(e,"use",(function(){return l})),r.d(e,"eventBusPromise",(function(){return g})),r.d(e,"EventBus",(function(){return y})),r.d(e,"Logger",(function(){return v})),r.d(e,"merge",(function(){return m})),r.d(e,"mapPromise",(function(){return C})),r.d(e,"ProofUtil",(function(){return j})),r.d(e,"HttpRequest",(function(){return S})),r.d(e,"Converter",(function(){return N})),r.d(e,"Web3SideChainClient",(function(){return F})),r.d(e,"BaseToken",(function(){return W})),r.d(e,"setProofApi",(function(){return D})),r.d(e,"resolve",(function(){return G})),r.d(e,"promiseResolve",(function(){return H})),r.d(e,"BridgeClient",(function(){return Z})),r.d(e,"ABIManager",(function(){return J})),r.d(e,"throwNotImplemented",(function(){return X})),r.d(e,"utils",(function(){return Y})),r.d(e,"Log_Event_Signature",(function(){return o})),r.d(e,"ERROR_TYPE",(function(){return i})),r.d(e,"ExitUtil",(function(){return nt})),r.d(e,"RootChainManager",(function(){return rt})),r.d(e,"RootChain",(function(){return st})),r.d(e,"POSClient",(function(){return dt})),r.d(e,"MAX_AMOUNT",(function(){return yt})),r.d(e,"BaseContractMethod",(function(){return a})),r.d(e,"BaseWeb3Client",(function(){return c})),r.d(e,"BaseContract",(function(){return s})),r.d(e,"BaseBigNumber",(function(){return u})),r.d(e,"NetworkService",(function(){return U})),r.d(e,"service",(function(){return q}));var n,o,i,a=function(t){this.logger=t},c=function(){function t(t){this.logger=t}return t.prototype.getRootHash=function(t,e){return this.sendRPCRequest({jsonrpc:"2.0",method:"eth_getRootHash",params:[Number(t),Number(e)],id:(new Date).getTime()}).then((function(t){return String(t.result)}))},t}(),s=function(t,e){this.address=t,this.logger=e},u=function(){function t(){}return t.isBN=function(t){return X()},t}(),f=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),h=function(t){function e(e){return t.call(this)||this}return f(e,t),e.prototype.toString=function(t){return X()},e.prototype.toNumber=function(){return X()},e.prototype.toBuffer=function(t){return X()},e.prototype.add=function(t){return X()},e.prototype.sub=function(t){return X()},e.prototype.mul=function(t){return X()},e.prototype.div=function(t){return X()},e.prototype.lte=function(t){return X()},e.prototype.lt=function(t){return X()},e.prototype.gte=function(t){return X()},e.prototype.gt=function(t){return X()},e.prototype.eq=function(t){return X()},e}(u),p=function(t,e,r){if(r||2===arguments.length)for(var n,o=0,i=e.length;o<i;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))},l=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];var n="function"==typeof t?new t:t;return n.setup.apply(n,p([gt],e,!1))},d=function(t,e,r){if(r||2===arguments.length)for(var n,o=0,i=e.length;o<i;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))},g=function(t){var e=new Promise(t),r=new y;return e.on=r.on.bind(r),e.emit=r.emit.bind(r),e},y=function(){function t(t){this._events={},this._ctx=t}return t.prototype.on=function(t,e){return null==this._events[t]&&(this._events[t]=[]),this._events[t].push(e),this},t.prototype.off=function(t,e){if(this._events[t])if(e){var r=this._events[t].indexOf(e);this._events[t].splice(r,1)}else this._events[t]=[]},t.prototype.emit=function(t){for(var e=this,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var o=this._events[t]||[];return Promise.all(o.map((function(t){var n=t.call.apply(t,d([e._ctx],r,!1));return n&&n.then?n:Promise.resolve(n)})))},t.prototype.destroy=function(){this._events=null,this._ctx=null},t}();!function(t){t.Erc20Transfer="0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef",t.Erc721Transfer="0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef",t.Erc1155Transfer="0xc3d58168c5ae7397731d063d5bbf3d657854427343f4c083240f7aacaa2d0f62",t.Erc721BatchTransfer="0xf871896b17e9cb7a64941c62c188a4f5c621b86800e3d15452ece01ce56073df",t.Erc1155BatchTransfer="0x4a39dc06d4c0dbc64b70af90fd698a233a518aa5d07e595d983b8c0526c8f7fb",t.Erc721TransferWithMetadata="0xf94915c6d1fd521cee85359239227480c7e8776d7caf1fc3bacad5c269b66a14"}(o||(o={})),function(t){t.AllowedOnRoot="allowed_on_root",t.AllowedOnChild="allowed_on_child",t.Unknown="unknown",t.ProofAPINotSet="proof_api_not_set",t.TransactionOptionNotObject="transation_object_not_object",t.BurnTxNotCheckPointed="burn_tx_not_checkpointed",t.EIP1559NotSupported="eip-1559_not_supported",t.NullSpenderAddress="null_spender_address"}(i||(i={}));var b=function(){function t(t,e){this.type=t,this.message=this.getMsg_(e)}return t.prototype.throw=function(){throw this.get()},t.prototype.get=function(){return{message:this.message,type:this.type}},t.prototype.getMsg_=function(t){var e;switch(this.type){case i.AllowedOnChild:e="The action ".concat(t," is allowed only on child token.");break;case i.AllowedOnRoot:e="The action ".concat(t," is allowed only on root token.");break;case i.ProofAPINotSet:e='Proof api is not set, please set it using "setProofApi"';break;case i.BurnTxNotCheckPointed:e="Burn transaction has not been checkpointed as yet";break;case i.EIP1559NotSupported:e="".concat(t?"Root":"Child"," chain doesn't support eip-1559");break;case i.NullSpenderAddress:e="Please provide spender address.";break;default:this.type||(this.type=i.Unknown),e=this.message}return e},t}(),v=function(){function t(){}return t.prototype.enableLog=function(t){this.isEnabled=!!t},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.isEnabled&&console.log.apply(console,t)},t.prototype.error=function(t,e){return new b(t,e)},t}(),w=function(t,e,r){if(r||2===arguments.length)for(var n,o=0,i=e.length;o<i;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))},m=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Object.assign.apply(Object,w([{}],t,!1))};function C(t,e,r){void 0===r&&(r={});var n=t.length,o=r.concurrency||n,i=[],a=function(){return function(t,e){var r=t.map((function(t,r){return e(t,r)}));return Promise.all(r)}(t.splice(0,o),e).then((function(t){return i=i.concat(t),n>i.length?a():H(i)}))};return a()}var x=r(1),P=r(0),k=P.keccak256,_=function(){function t(t){if(void 0===t&&(t=[]),t.length<1)throw new Error("Atleast 1 leaf needed");var e=Math.ceil(Math.log(t.length)/Math.log(2));if(e>20)throw new Error("Depth must be 20 or less");this.leaves=t.concat(Array.from(Array(Math.pow(2,e)-t.length),(function(){return P.zeros(32)}))),this.layers=[this.leaves],this.createHashes(this.leaves)}return t.prototype.createHashes=function(t){if(1===t.length)return!1;for(var e=[],r=0;r<t.length;r+=2){var n=t[r],o=t[r+1],i=x.Buffer.concat([n,o]);e.push(k(i))}t.length%2==1&&e.push(t[t.length-1]),this.layers.push(e),this.createHashes(e)},t.prototype.getLeaves=function(){return this.leaves},t.prototype.getLayers=function(){return this.layers},t.prototype.getRoot=function(){return this.layers[this.layers.length-1][0]},t.prototype.getProof=function(t){for(var e=-1,r=0;r<this.leaves.length;r++)0===x.Buffer.compare(t,this.leaves[r])&&(e=r);var n=[];if(e<=this.getLeaves().length){var o=void 0;for(r=0;r<this.layers.length-1;r++)o=e%2==0?e+1:e-1,e=Math.floor(e/2),n.push(this.layers[r][o])}return n},t.prototype.verify=function(t,e,r,n){if(!Array.isArray(n)||!t||!r)return!1;for(var o=t,i=0;i<n.length;i++){var a=n[i];o=k(e%2==0?x.Buffer.concat([o,a]):x.Buffer.concat([a,o])),e=Math.floor(e/2)}return 0===x.Buffer.compare(o,r)},t}(),B=r(0),E=r(3),A=r(4),O=r(2),R=r.n(O),T=function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{s(n.next(t))}catch(t){i(t)}}function c(t){try{s(n.throw(t))}catch(t){i(t)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,c)}s((n=n.apply(t,e||[])).next())}))},I=function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}},j=function(){function t(){}return t.getFastMerkleProof=function(t,e,r,n){return T(this,void 0,void 0,(function(){var o,i,a,c,s,u,f,h,p;return I(this,(function(l){switch(l.label){case 0:o=Math.ceil(Math.log2(n-r+1)),i=[],c=e-(a=r),s=0,u=n-a,f=function(e){var r,n,f,p,l,d,g,y,b,v,w;return I(this,(function(m){switch(m.label){case 0:return r=Math.pow(2,o-e),c>(n=s+r/2-1)?(f=n+1,[4,h.queryRootHash(t,a+s,a+n)]):[3,2];case 1:return w=m.sent(),i.push(w),s=f,[3,6];case 2:return p=Math.min(u,n),l=o-(e+1),u<=n?(w=h.recursiveZeroHash(l,t),i.push(w),[3,5]):[3,3];case 3:return d=Math.ceil(Math.log2(u-n)),g=l-d,[4,h.queryRootHash(t,a+n+1,a+u)];case 4:y=m.sent(),b=h.recursiveZeroHash(d,t),(v=Array.from({length:Math.pow(2,g)},(function(){return Object(B.toBuffer)(b)})))[0]=y,w=new _(v).getRoot(),i.push(w),m.label=5;case 5:u=p,m.label=6;case 6:return[2]}}))},h=this,p=0,l.label=1;case 1:return p<o?[5,f(p)]:[3,4];case 2:l.sent(),l.label=3;case 3:return p+=1,[3,1];case 4:return[2,i.reverse()]}}))}))},t.buildBlockProof=function(e,r,n,o){return t.getFastMerkleProof(e,o,r,n).then((function(t){return Object(B.bufferToHex)(Buffer.concat(t.map((function(t){return Object(B.toBuffer)(t)}))))}))},t.queryRootHash=function(t,e,r){return t.getRootHash(e,r).then((function(t){return Object(B.toBuffer)("0x".concat(t))})).catch((function(t){return null}))},t.recursiveZeroHash=function(t,e){if(0===t)return"0x0000000000000000000000000000000000000000000000000000000000000000";var r=this.recursiveZeroHash(t-1,e);return Object(B.keccak256)(Object(B.toBuffer)(e.encodeParameters([r,r],["bytes32","bytes32"])))},t.getReceiptProof=function(e,r,n,o,i){void 0===o&&(o=1/0);var a,c=Object(B.bufferToHex)(t.getStateSyncTxHash(r)),s=new E.BaseTrie;if(i)a=H(i);else{var u=[];r.transactions.forEach((function(t){t.transactionHash!==c&&u.push(n.getTransactionReceipt(t.transactionHash))})),a=C(u,(function(t){return t}),{concurrency:o})}return a.then((function(e){return Promise.all(e.map((function(e){var r=B.rlp.encode(e.transactionIndex),n=t.getReceiptBytes(e);return s.put(r,n)})))})).then((function(t){return s.findPath(B.rlp.encode(e.transactionIndex),!0)})).then((function(n){if(n.remaining.length>0)throw new Error("Node does not contain the key");return{blockHash:Object(B.toBuffer)(e.blockHash),parentNodes:n.stack.map((function(t){return t.raw()})),root:t.getRawHeader(r).receiptTrie,path:B.rlp.encode(e.transactionIndex),value:t.isTypedReceipt(e)?n.node.value:B.rlp.decode(n.node.value)}}))},t.isTypedReceipt=function(t){var e=N.toHex(t.type);return null!=t.status&&"0x0"!==e&&"0x"!==e},t.getStateSyncTxHash=function(t){return Object(B.keccak256)(Buffer.concat([Buffer.from("matic-bor-receipt-","utf-8"),Object(B.setLengthLeft)(Object(B.toBuffer)(t.number),8),Object(B.toBuffer)(t.hash)]))},t.getReceiptBytes=function(e){var r=B.rlp.encode([Object(B.toBuffer)(void 0!==e.status&&null!=e.status?e.status?"0x1":"0x":e.root),Object(B.toBuffer)(e.cumulativeGasUsed),Object(B.toBuffer)(e.logsBloom),e.logs.map((function(t){return[Object(B.toBuffer)(t.address),t.topics.map(B.toBuffer),Object(B.toBuffer)(t.data)]}))]);return t.isTypedReceipt(e)&&(r=Buffer.concat([Object(B.toBuffer)(e.type),r])),r},t.getRawHeader=function(t){t.difficulty=N.toHex(t.difficulty);var e=new R.a({chain:O.Chain.Mainnet,hardfork:O.Hardfork.London});return A.BlockHeader.fromHeaderData(t,{common:e})},t}(),M=r(6).default,S=function(){function t(t){void 0===t&&(t={}),this.baseUrl="",(t="string"==typeof t?{baseUrl:t}:t).baseUrl&&(this.baseUrl=t.baseUrl)}return t.prototype.get=function(t,e){return void 0===t&&(t=""),void 0===e&&(e={}),t=this.baseUrl+t+Object.keys(e).map((function(t){return"".concat(encodeURIComponent(t),"=").concat(encodeURIComponent(e[t]))})).join("&"),M(t,{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}}).then((function(t){return t.json()}))},t.prototype.post=function(t,e){return void 0===t&&(t=""),t=this.baseUrl+t,M(t,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:e?JSON.stringify(e):null}).then((function(t){return t.json()}))},t}(),N=function(){function t(){}return t.toHex=function(t){var e=typeof t;if("number"===e)t=new Y.BN(t);else if("string"===e){if("0x"===t.slice(0,2))return t;t=new Y.BN(t)}if(Y.BN.isBN(t))return"0x"+t.toString(16);throw new Error("Invalid value ".concat(t,", value is not a number."))},t}(),F=function(){function t(){this.logger=new v}return t.prototype.init=function(t){(t=t||{}).parent.defaultConfig=t.parent.defaultConfig||{},t.child.defaultConfig=t.child.defaultConfig||{},this.config=t;var e=Y.Web3Client;if(!e)throw new Error("Web3Client is not set");Y.UnstoppableDomains&&(this.resolution=Y.UnstoppableDomains),this.parent=new e(t.parent.provider,this.logger),this.child=new e(t.child.provider,this.logger),this.logger.enableLog(t.log);var r=t.network,n=t.version,o=this.abiManager=new J(r,n);return this.logger.log("init called",o),o.init().catch((function(t){throw new Error("network ".concat(r," - ").concat(n," is not supported"))}))},t.prototype.getABI=function(t,e){return this.abiManager.getABI(t,e)},t.prototype.getConfig=function(t){return this.abiManager.getConfig(t)},Object.defineProperty(t.prototype,"mainPlasmaContracts",{get:function(){return this.getConfig("Main.Contracts")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"mainPOSContracts",{get:function(){return this.getConfig("Main.POSContracts")},enumerable:!1,configurable:!0}),t.prototype.isEIP1559Supported=function(t){return t?this.getConfig("Main.SupportsEIP1559"):this.getConfig("Matic.SupportsEIP1559")},t}(),H=function(t){return Promise.resolve(t)},W=function(){function t(t,e){this.contractParam=t,this.client=e}return t.prototype.getContract=function(){var t=this;if(this.contract_)return H(this.contract_);var e=this.contractParam;return this.client.getABI(e.name,e.bridgeType).then((function(r){return t.contract_=t.getContract_({abi:r,isParent:e.isParent,tokenAddress:e.address}),t.contract_}))},t.prototype.processWrite=function(t,e){var r=this;return void 0===e&&(e={}),this.validateTxOption_(e),this.client.logger.log("process write"),this.createTransactionConfig({txConfig:e,isWrite:!0,method:t,isParent:this.contractParam.isParent}).then((function(n){return r.client.logger.log("process write config"),e.returnTransaction?m(n,{data:t.encodeABI(),to:t.address}):t.write(n)}))},t.prototype.sendTransaction=function(t){void 0===t&&(t={}),this.validateTxOption_(t);var e=this.contractParam.isParent,r=this.getClient(e);return r.logger.log("process write"),this.createTransactionConfig({txConfig:t,isWrite:!0,method:null,isParent:this.contractParam.isParent}).then((function(e){return r.logger.log("process write config"),t.returnTransaction?e:r.write(e)}))},t.prototype.readTransaction=function(t){void 0===t&&(t={}),this.validateTxOption_(t);var e=this.contractParam.isParent,r=this.getClient(e);return r.logger.log("process read"),this.createTransactionConfig({txConfig:t,isWrite:!0,method:null,isParent:this.contractParam.isParent}).then((function(e){return r.logger.log("write tx config created"),t.returnTransaction?e:r.read(e)}))},t.prototype.validateTxOption_=function(t){("object"!=typeof t||Array.isArray(t))&&new b(i.TransactionOptionNotObject).throw()},t.prototype.processRead=function(t,e){var r=this;return void 0===e&&(e={}),this.validateTxOption_(e),this.client.logger.log("process read"),this.createTransactionConfig({txConfig:e,isWrite:!1,method:t,isParent:this.contractParam.isParent}).then((function(n){return r.client.logger.log("read tx config created"),e.returnTransaction?m(n,{data:t.encodeABI(),to:r.contract_.address}):t.read(n)}))},t.prototype.getClient=function(t){return t?this.client.parent:this.client.child},t.prototype.getContract_=function(t){var e=t.isParent,r=t.tokenAddress,n=t.abi;return this.getClient(e).getContract(r,n)},Object.defineProperty(t.prototype,"parentDefaultConfig",{get:function(){return this.client.config.parent.defaultConfig},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"childDefaultConfig",{get:function(){return this.client.config.child.defaultConfig},enumerable:!1,configurable:!0}),t.prototype.createTransactionConfig=function(t){var e=t.txConfig,r=t.method,n=t.isParent,o=t.isWrite,a=n?this.parentDefaultConfig:this.childDefaultConfig;e=m(a,e||{});var c=n?this.client.parent:this.client.child;c.logger.log("txConfig",e,"onRoot",n,"isWrite",o);var s;if(o){var u=e.maxFeePerGas,f=e.maxPriorityFeePerGas;return!this.client.isEIP1559Supported(n)&&(u||f)&&c.logger.error(i.EIP1559NotSupported,n).throw(),Promise.all([e.gasLimit?e.gasLimit:(s={from:e.from,value:e.value},r?r.estimateGas(s):c.estimateGas(s)),e.nonce?e.nonce:c.getTransactionCount(e.from,"pending"),e.chainId?e.chainId:c.getChainId()]).then((function(t){var r=t[0],n=t[1],o=t[2];return c.logger.log("options filled"),e.gasLimit=Number(r),e.nonce=n,e.chainId=o,e}))}return H(e)},t.prototype.transferERC20=function(t,e,r){var n=this;return this.getContract().then((function(o){var i=o.method("transfer",t,N.toHex(e));return n.processWrite(i,r)}))},t.prototype.transferERC721=function(t,e,r,n){var o=this;return this.getContract().then((function(i){var a=i.method("transferFrom",t,e,r);return o.processWrite(a,n)}))},t.prototype.checkForRoot=function(t){this.contractParam.isParent||this.client.logger.error(i.AllowedOnRoot,t).throw()},t.prototype.checkForChild=function(t){this.contractParam.isParent&&this.client.logger.error(i.AllowedOnChild,t).throw()},t.prototype.transferERC1155=function(t,e){var r=this;return this.getContract().then((function(n){var o=n.method("safeTransferFrom",t.from,t.to,N.toHex(t.tokenId),N.toHex(t.amount),t.data||"0x");return r.processWrite(o,e)}))},t}(),L=function(){function t(t){this.httpRequest=new S(t)}return t.prototype.getABI=function(t,e,r,n){var o="".concat(t,"/").concat(e,"/artifacts/").concat(r,"/").concat(n,".json");return this.httpRequest.get(o).then((function(t){return t.abi}))},t.prototype.getAddress=function(t,e){var r="".concat(t,"/").concat(e,"/index.json");return this.httpRequest.get(r)},t}(),U=function(){function t(t){this.httpRequest=new S(t)}return t.prototype.createUrl=function(t,e){return"".concat("mainnet"===t?"matic":"mumbai").concat(e)},t.prototype.getBlockIncluded=function(t,e){var r=this.createUrl(t,"/block-included/".concat(e));return this.httpRequest.get(r).then((function(t){var e=t.headerBlockNumber,r="0x"===e.slice(0,2)?parseInt(e,16):e;return t.headerBlockNumber=new Y.BN(r),t}))},t.prototype.getProof=function(t,e,r,n){var o=this.createUrl(t,"/fast-merkle-proof?start=".concat(e,"&end=").concat(r,"&number=").concat(n));return this.httpRequest.get(o).then((function(t){return t.proof}))},t}(),q=new function(){};q.abi=new L("https://static.matic.network/network/");var D=function(t){"/"!==t[t.length-1]&&(t+="/"),t+="api/v1/",q.network=new U(t)};function G(t,e){return(Array.isArray(e)?e:e.split(".")).reduce((function(t,e){return t&&t[e]}),t)}var Z=function(){function t(){this.client=new F}return t.prototype.isCheckPointed=function(t){return this.exitUtil.isCheckPointed(t)},t.prototype.isDeposited=function(t){var e=this.client,r=new W({address:e.abiManager.getConfig("Matic.GenesisContracts.StateReceiver"),isParent:!1,name:"StateReceiver",bridgeType:"genesis"},e);return r.getContract().then((function(n){return Promise.all([e.parent.getTransactionReceipt(t),r.processRead(n.method("lastStateId"))])})).then((function(t){var r=t[0],n=t[1],o=r.logs.find((function(t){return"0x103fed9db65eac19c4d870f49ab7520fe03b99f1838e5996caf47e9e43308392"===t.topics[0]}));if(!o)throw new Error("StateSynced event not found");var i=e.child.decodeParameters(o.topics[1],["uint256"])[0],a=Y.BN.isBN(i)?i:new Y.BN(i);return new Y.BN(n).gte(a)}))},t}(),z={},J=function(){function t(t,e){this.networkName=t,this.version=e}return t.prototype.init=function(){var t=this;return q.abi.getAddress(this.networkName,this.version).then((function(e){var r;z[t.networkName]=((r={})[t.version]={address:e,abi:{}},r)}))},t.prototype.getConfig=function(t){return G(z[this.networkName][this.version].address,t)},t.prototype.getABI=function(t,e){var r=this;void 0===e&&(e="plasma");var n=z[this.networkName][this.version].abi[e];if(n){var o=n[t];if(o)return H(o)}return q.abi.getABI(this.networkName,this.version,e,t).then((function(n){return r.setABI(t,e,n),n}))},t.prototype.setABI=function(t,e,r){var n=z[this.networkName][this.version].abi;n[e]||(n[e]={}),n[e][t]=r},t}(),X=function(){throw new Error("not implemented")},Y={converter:N,Web3Client:c,BN:h,UnstoppableDomains:Object},K=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Q=function(t){function e(e,r,n){var o=t.call(this,e,r)||this;return o.getPOSContracts=n,o}return K(e,t),Object.defineProperty(e.prototype,"rootChainManager",{get:function(){return this.getPOSContracts().rootChainManager},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"exitUtil",{get:function(){return this.getPOSContracts().exitUtil},enumerable:!1,configurable:!0}),e.prototype.getPredicateAddress=function(){var t=this;return this.predicateAddress?H(this.predicateAddress):this.rootChainManager.method("tokenToType",this.contractParam.address).then((function(t){return t.read()})).then((function(e){if(!e)throw new Error("Invalid Token Type");return t.rootChainManager.method("typeToPredicate",e)})).then((function(t){return t.read()})).then((function(e){return t.predicateAddress=e,e}))},e.prototype.isWithdrawn=function(t,e){var r=this;if(!t)throw new Error("txHash not provided");return this.exitUtil.getExitHash(t,0,e).then((function(t){return r.rootChainManager.isExitProcessed(t)}))},e.prototype.isWithdrawnOnIndex=function(t,e,r){var n=this;if(!t)throw new Error("txHash not provided");return this.exitUtil.getExitHash(t,e,r).then((function(t){return n.rootChainManager.isExitProcessed(t)}))},e.prototype.withdrawExitPOS=function(t,e,r,n){var o=this;return this.exitUtil.buildPayloadForExit(t,e,r).then((function(t){return o.rootChainManager.exit(t,n)}))},e}(W),V=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),$=function(t){function e(e,r,n,o){return t.call(this,{isParent:r,address:e,name:"ChildERC20",bridgeType:"pos"},n,o)||this}return V(e,t),e.prototype.getBalance=function(t,e){var r=this;return this.getContract().then((function(n){var o=n.method("balanceOf",t);return r.processRead(o,e)}))},e.prototype.getAllowance=function(t,e){var r=this;void 0===e&&(e={});var n=e.spenderAddress,o=n?H(n):this.getPredicateAddress();return Promise.all([o,this.getContract()]).then((function(n){var o=n[0],i=n[1].method("allowance",t,o);return r.processRead(i,e)}))},e.prototype.approve=function(t,e){var r=this;void 0===e&&(e={});var n=e.spenderAddress;n||this.contractParam.isParent||this.client.logger.error(i.NullSpenderAddress).throw();var o=n?H(n):this.getPredicateAddress();return Promise.all([o,this.getContract()]).then((function(n){var o=n[0],i=n[1].method("approve",o,N.toHex(t));return r.processWrite(i,e)}))},e.prototype.approveMax=function(t){return void 0===t&&(t={}),this.approve(yt,t)},e.prototype.deposit=function(t,e,r){this.checkForRoot("deposit");var n=this.client.parent.encodeParameters([N.toHex(t)],["uint256"]);return this.rootChainManager.deposit(e,this.contractParam.address,n,r)},e.prototype.depositEther_=function(t,e,r){var n=this;return void 0===r&&(r={}),this.checkForRoot("depositEther"),r.value=N.toHex(t),this.rootChainManager.method("depositEtherFor",e).then((function(t){return n.processWrite(t,r)}))},e.prototype.withdrawStart=function(t,e){var r=this;return this.checkForChild("withdrawStart"),this.getContract().then((function(n){var o=n.method("withdraw",N.toHex(t));return r.processWrite(o,e)}))},e.prototype.withdrawExit_=function(t,e,r){var n=this;void 0===r&&(r={});var i=r.burnEventSignature?r.burnEventSignature:o.Erc20Transfer;return this.exitUtil.buildPayloadForExit(t,i,e).then((function(t){return n.rootChainManager.exit(t,r)}))},e.prototype.withdrawExit=function(t,e){return this.checkForRoot("withdrawExit"),this.withdrawExit_(t,!1,e)},e.prototype.withdrawExitFaster=function(t,e){return this.checkForRoot("withdrawExitFaster"),this.withdrawExit_(t,!0,e)},e.prototype.isWithdrawExited=function(t){return this.isWithdrawn(t,o.Erc20Transfer)},e.prototype.transfer=function(t,e,r){return this.transferERC20(e,t,r)},e}(Q),tt=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),et=function(t,e,r){if(r||2===arguments.length)for(var n,o=0,i=e.length;o<i;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))},rt=function(t){function e(e,r){return t.call(this,{address:r,name:"RootChainManager",bridgeType:"pos",isParent:!0},e)||this}return tt(e,t),e.prototype.method=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return this.getContract().then((function(r){return r.method.apply(r,et([t],e,!1))}))},e.prototype.deposit=function(t,e,r,n){var o=this;return this.method("depositFor",t,e,r).then((function(t){return o.processWrite(t,n)}))},e.prototype.exit=function(t,e){var r=this;return this.method("exit",t).then((function(t){return r.processWrite(t,e)}))},e.prototype.isExitProcessed=function(t){var e=this;return this.method("processedExits",t).then((function(t){return e.processRead(t)}))},e}(W),nt=function(){function t(t,e){this.maticClient_=t.child,this.rootChain=e;var r=t.config;this.config=r,this.requestConcurrency=r.requestConcurrency}return t.prototype.getLogIndex_=function(t,e){var r=-1;switch(t){case"0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef":case"0xf94915c6d1fd521cee85359239227480c7e8776d7caf1fc3bacad5c269b66a14":r=e.logs.findIndex((function(e){return e.topics[0].toLowerCase()===t.toLowerCase()&&"0x0000000000000000000000000000000000000000000000000000000000000000"===e.topics[2].toLowerCase()}));break;case"0xc3d58168c5ae7397731d063d5bbf3d657854427343f4c083240f7aacaa2d0f62":case"0x4a39dc06d4c0dbc64b70af90fd698a233a518aa5d07e595d983b8c0526c8f7fb":r=e.logs.findIndex((function(e){return e.topics[0].toLowerCase()===t.toLowerCase()&&"0x0000000000000000000000000000000000000000000000000000000000000000"===e.topics[3].toLowerCase()}));break;default:r=e.logs.findIndex((function(e){return e.topics[0].toLowerCase()===t.toLowerCase()}))}if(r<0)throw new Error("Log not found in receipt");return r},t.prototype.getAllLogIndices_=function(t,e){var r=[];switch(t){case"0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef":case"0xf94915c6d1fd521cee85359239227480c7e8776d7caf1fc3bacad5c269b66a14":r=e.logs.reduce((function(e,n,o){return n.topics[0].toLowerCase()===t.toLowerCase()&&"0x0000000000000000000000000000000000000000000000000000000000000000"===n.topics[2].toLowerCase()&&r.push(o),r}),[]);break;case"0xc3d58168c5ae7397731d063d5bbf3d657854427343f4c083240f7aacaa2d0f62":case"0x4a39dc06d4c0dbc64b70af90fd698a233a518aa5d07e595d983b8c0526c8f7fb":r=e.logs.reduce((function(e,n,o){return n.topics[0].toLowerCase()===t.toLowerCase()&&"0x0000000000000000000000000000000000000000000000000000000000000000"===n.topics[3].toLowerCase()&&r.push(o),r}),[]);break;case"0xf871896b17e9cb7a64941c62c188a4f5c621b86800e3d15452ece01ce56073df":r=e.logs.reduce((function(t,e,n){return"0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"===e.topics[0].toLowerCase()&&"0x0000000000000000000000000000000000000000000000000000000000000000"===e.topics[2].toLowerCase()&&r.push(n),r}),[]);break;default:r=e.logs.reduce((function(e,n,o){return n.topics[0].toLowerCase()===t.toLowerCase()&&r.push(o),r}),[])}if(0===r.length)throw new Error("Log not found in receipt");return r},t.prototype.getChainBlockInfo=function(t){return Promise.all([this.rootChain.getLastChildBlock(),this.maticClient_.getTransaction(t)]).then((function(t){return{lastChildBlock:t[0],txBlockNumber:t[1].blockNumber}}))},t.prototype.isCheckPointed_=function(t){return new Y.BN(t.lastChildBlock).gte(new Y.BN(t.txBlockNumber))},t.prototype.isCheckPointed=function(t){var e=this;return this.getChainBlockInfo(t).then((function(t){return e.isCheckPointed_(t)}))},t.prototype.getRootBlockInfo=function(t){var e,r=this;return this.rootChain.findRootBlockFromChild(t).then((function(t){return e=t,r.rootChain.method("headerBlocks",N.toHex(t))})).then((function(t){return t.read()})).then((function(t){return{headerBlockNumber:e,end:t.end.toString(),start:t.start.toString()}}))},t.prototype.getRootBlockInfoFromAPI=function(t){var e=this;return this.maticClient_.logger.log("block info from API 1"),q.network.getBlockIncluded(this.config.network,t).then((function(t){if(e.maticClient_.logger.log("block info from API 2",t),!(t&&t.start&&t.end&&t.headerBlockNumber))throw Error("Network API Error");return t})).catch((function(r){return e.maticClient_.logger.log("block info from API",r),e.getRootBlockInfo(t)}))},t.prototype.getBlockProof=function(t,e){return j.buildBlockProof(this.maticClient_,parseInt(e.start,10),parseInt(e.end,10),parseInt(t+"",10))},t.prototype.getBlockProofFromAPI=function(t,e){var r=this;return q.network.getProof(this.config.network,e.start,e.end,t).then((function(t){if(!t)throw Error("Network API Error");return r.maticClient_.logger.log("block proof from API 1"),t})).catch((function(n){return r.getBlockProof(t,e)}))},t.prototype.buildPayloadForExit=function(t,e,r,n){var o,a,c,s,u,f=this;if(void 0===n&&(n=0),r&&!q.network&&new b(i.ProofAPINotSet).throw(),n<0)throw new Error("Index must not be a negative integer");return this.getChainBlockInfo(t).then((function(e){if(!f.isCheckPointed_(e))throw new Error("Burn transaction has not been checkpointed as yet");return o=e.txBlockNumber,Promise.all([f.maticClient_.getTransactionReceipt(t),f.maticClient_.getBlockWithTransaction(o)])})).then((function(t){return c=t[0],s=t[1],r?f.getRootBlockInfoFromAPI(o):f.getRootBlockInfo(o)})).then((function(t){return a=t,r?f.getBlockProofFromAPI(o,a):f.getBlockProof(o,a)})).then((function(t){return u=t,j.getReceiptProof(c,s,f.maticClient_,f.requestConcurrency)})).then((function(t){if(n>0){var r=f.getAllLogIndices_(e,c);if(n>=r.length)throw new Error("Index is grater than the number of tokens in this transaction");return f.encodePayload_(a.headerBlockNumber.toNumber(),u,o,s.timestamp,Buffer.from(s.transactionsRoot.slice(2),"hex"),Buffer.from(s.receiptsRoot.slice(2),"hex"),j.getReceiptBytes(c),t.parentNodes,t.path,r[n])}var i=f.getLogIndex_(e,c);return f.encodePayload_(a.headerBlockNumber.toNumber(),u,o,s.timestamp,Buffer.from(s.transactionsRoot.slice(2),"hex"),Buffer.from(s.receiptsRoot.slice(2),"hex"),j.getReceiptBytes(c),t.parentNodes,t.path,i)}))},t.prototype.buildMultiplePayloadsForExit=function(t,e,r){var n,o,a,c,s,u=this;return r&&!q.network&&new b(i.ProofAPINotSet).throw(),this.getChainBlockInfo(t).then((function(e){if(!u.isCheckPointed_(e))throw new Error("Burn transaction has not been checkpointed as yet");return n=e.txBlockNumber,Promise.all([u.maticClient_.getTransactionReceipt(t),u.maticClient_.getBlockWithTransaction(n)])})).then((function(t){return a=t[0],c=t[1],r?u.getRootBlockInfoFromAPI(n):u.getRootBlockInfo(n)})).then((function(t){return o=t,r?u.getBlockProofFromAPI(n,o):u.getBlockProof(n,o)})).then((function(t){return s=t,j.getReceiptProof(a,c,u.maticClient_,u.requestConcurrency)})).then((function(t){for(var r=[],i=0,f=u.getAllLogIndices_(e,a);i<f.length;i++){var h=f[i];r.push(u.encodePayload_(o.headerBlockNumber.toNumber(),s,n,c.timestamp,Buffer.from(c.transactionsRoot.slice(2),"hex"),Buffer.from(c.receiptsRoot.slice(2),"hex"),j.getReceiptBytes(a),t.parentNodes,t.path,h))}return r}))},t.prototype.encodePayload_=function(t,e,r,n,o,i,a,c,s,u){return Object(B.bufferToHex)(B.rlp.encode([t,e,r,n,Object(B.bufferToHex)(o),Object(B.bufferToHex)(i),Object(B.bufferToHex)(a),Object(B.bufferToHex)(B.rlp.encode(c)),Object(B.bufferToHex)(Buffer.concat([Buffer.from("00","hex"),s])),u]))},t.prototype.getExitHash=function(t,e,r){var n,o,a,c=this;return Promise.all([this.rootChain.getLastChildBlock(),this.maticClient_.getTransactionReceipt(t)]).then((function(t){return n=t[0],o=t[1],c.maticClient_.getBlockWithTransaction(o.blockNumber)})).then((function(t){return a=t,c.isCheckPointed_({lastChildBlock:n,txBlockNumber:o.blockNumber})||c.maticClient_.logger.error(i.BurnTxNotCheckPointed).throw(),j.getReceiptProof(o,a,c.maticClient_,c.requestConcurrency)})).then((function(t){var n,i=[];(t.path.forEach((function(t){i.push(Buffer.from("0"+(t/16).toString(16),"hex")),i.push(Buffer.from("0"+(t%16).toString(16),"hex"))})),e>0)&&(n=c.getAllLogIndices_(r,o)[e]);return n=c.getLogIndex_(r,o),c.maticClient_.etheriumSha3(o.blockNumber,Object(B.bufferToHex)(Buffer.concat(i)),n)}))},t}(),ot=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),it=function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{s(n.next(t))}catch(t){i(t)}}function c(t){try{s(n.throw(t))}catch(t){i(t)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,c)}s((n=n.apply(t,e||[])).next())}))},at=function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}},ct=function(t,e,r){if(r||2===arguments.length)for(var n,o=0,i=e.length;o<i;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))},st=function(t){function e(e,r){return t.call(this,{address:r,name:"RootChain",isParent:!0},e)||this}return ot(e,t),e.prototype.method=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return this.getContract().then((function(r){return r.method.apply(r,ct([t],e,!1))}))},e.prototype.getLastChildBlock=function(){return this.method("getLastChildBlock").then((function(t){return t.read({},"finalized")}))},e.prototype.findRootBlockFromChild=function(t){return it(this,void 0,void 0,(function(){var e,r,n,o,i,a,c,s,u,f,h;return at(this,(function(p){switch(p.label){case 0:return e=new Y.BN(1),r=new Y.BN(2),n=new Y.BN(1e4),t=new Y.BN(t),o=e,[4,this.method("currentHeaderBlock")];case 1:return[4,p.sent().read()];case 2:i=p.sent(),a=new Y.BN(i).div(n),p.label=3;case 3:return o.lte(a)?o.eq(a)?(c=o,[3,6]):(s=o.add(a).div(r),[4,this.method("headerBlocks",s.mul(n).toString())]):[3,6];case 4:return[4,p.sent().read()];case 5:return u=p.sent(),f=new Y.BN(u.start),h=new Y.BN(u.end),f.lte(t)&&t.lte(h)?(c=s,[3,6]):(f.gt(t)?a=s.sub(e):h.lt(t)&&(o=s.add(e)),[3,3]);case 6:return[2,c.mul(n)]}}))}))},e}(W),ut=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),ft=function(t){function e(e,r,n,o){return t.call(this,{isParent:r,address:e,name:"ChildERC721",bridgeType:"pos"},n,o)||this}return ut(e,t),e.prototype.validateMany_=function(t){if(t.length>20)throw new Error("can not process more than 20 tokens");return t.map((function(t){return N.toHex(t)}))},e.prototype.getTokensCount=function(t,e){var r=this;return this.getContract().then((function(n){var o=n.method("balanceOf",t);return r.processRead(o,e)})).then((function(t){return Number(t)}))},e.prototype.getTokenIdAtIndexForUser=function(t,e,r){var n=this;return this.getContract().then((function(o){var i=o.method("tokenOfOwnerByIndex",e,t);return n.processRead(i,r)}))},e.prototype.getAllTokens=function(t,e){var r=this;return void 0===e&&(e=1/0),this.getTokensCount(t).then((function(n){(n=Number(n))>e&&(n=e);for(var o=[],i=0;i<n;i++)o.push(r.getTokenIdAtIndexForUser(i,t));return Promise.all(o)}))},e.prototype.isApproved=function(t,e){var r=this;return this.checkForRoot("isApproved"),this.getContract().then((function(n){var o=n.method("getApproved",t);return Promise.all([r.processRead(o,e),r.getPredicateAddress()]).then((function(t){return t[0]===t[1]}))}))},e.prototype.isApprovedAll=function(t,e){var r=this;return this.checkForRoot("isApprovedAll"),Promise.all([this.getContract(),this.getPredicateAddress()]).then((function(n){var o=n[0],i=n[1],a=o.method("isApprovedForAll",t,i);return r.processRead(a,e)}))},e.prototype.approve=function(t,e){var r=this;return this.checkForRoot("approve"),Promise.all([this.getContract(),this.getPredicateAddress()]).then((function(n){var o=n[0],i=n[1],a=o.method("approve",i,N.toHex(t));return r.processWrite(a,e)}))},e.prototype.approveAll=function(t){var e=this;return this.checkForRoot("approveAll"),Promise.all([this.getContract(),this.getPredicateAddress()]).then((function(r){var n=r[0],o=r[1],i=n.method("setApprovalForAll",o,!0);return e.processWrite(i,t)}))},e.prototype.deposit=function(t,e,r){this.checkForRoot("deposit");var n=this.client.parent.encodeParameters([N.toHex(t)],["uint256"]);return this.rootChainManager.deposit(e,this.contractParam.address,n,r)},e.prototype.depositMany=function(t,e,r){this.checkForRoot("depositMany");var n=this.validateMany_(t),o=this.client.parent.encodeParameters([n],["uint256[]"]);return this.rootChainManager.deposit(e,this.contractParam.address,o,r)},e.prototype.withdrawStart=function(t,e){var r=this;return this.checkForChild("withdrawStart"),this.getContract().then((function(n){var o=n.method("withdraw",N.toHex(t));return r.processWrite(o,e)}))},e.prototype.withdrawStartWithMetaData=function(t,e){var r=this;return this.checkForChild("withdrawStartWithMetaData"),this.getContract().then((function(n){var o=n.method("withdrawWithMetadata",N.toHex(t));return r.processWrite(o,e)}))},e.prototype.withdrawStartMany=function(t,e){var r=this;this.checkForChild("withdrawStartMany");var n=this.validateMany_(t);return this.getContract().then((function(t){var o=t.method("withdrawBatch",n);return r.processWrite(o,e)}))},e.prototype.withdrawExit=function(t,e){var r=this;return this.checkForRoot("withdrawExit"),this.exitUtil.buildPayloadForExit(t,o.Erc721Transfer,!1).then((function(t){return r.rootChainManager.exit(t,e)}))},e.prototype.withdrawExitOnIndex=function(t,e,r){var n=this;return this.checkForRoot("withdrawExit"),this.exitUtil.buildPayloadForExit(t,o.Erc721Transfer,!1,e).then((function(t){return n.rootChainManager.exit(t,r)}))},e.prototype.withdrawExitFaster=function(t,e){var r=this;return this.checkForRoot("withdrawExitFaster"),this.exitUtil.buildPayloadForExit(t,o.Erc721Transfer,!0).then((function(t){return r.rootChainManager.exit(t,e)}))},e.prototype.isWithdrawExited=function(t){return this.isWithdrawn(t,o.Erc721Transfer)},e.prototype.isWithdrawExitedMany=function(t){return this.isWithdrawn(t,o.Erc721BatchTransfer)},e.prototype.isWithdrawExitedOnIndex=function(t,e){return this.isWithdrawnOnIndex(t,e,o.Erc721Transfer)},e.prototype.transfer=function(t,e,r,n){return this.transferERC721(e,r,t,n)},e}(Q),ht=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),pt=function(t){function e(e,r,n,o){return t.call(this,{isParent:r,address:e,name:"ChildERC1155",bridgeType:"pos"},n,o)||this}return ht(e,t),Object.defineProperty(e.prototype,"addressConfig",{get:function(){return this.client.config.erc1155||{}},enumerable:!1,configurable:!0}),e.prototype.getAddress_=function(t){var e=this.addressConfig;return e[t]?H(e[t]):this.client.getConfig(t)},e.prototype.getBalance=function(t,e,r){var n=this;return this.getContract().then((function(o){var i=o.method("balanceOf",t,N.toHex(e));return n.processRead(i,r)}))},e.prototype.isApprovedAll=function(t,e){var r=this;return this.checkForRoot("isApprovedAll"),Promise.all([this.getContract(),this.getPredicateAddress()]).then((function(n){var o=n[0],i=n[1],a=o.method("isApprovedForAll",t,i);return r.processRead(a,e)}))},e.prototype.approveAll_=function(t,e){var r=this;return this.checkForRoot("approve"),Promise.all([this.getContract(),t]).then((function(t){var n=t[0],o=t[1],i=n.method("setApprovalForAll",o,!0);return r.processWrite(i,e)}))},e.prototype.approveAll=function(t){return this.checkForRoot("approve"),this.approveAll_(this.getPredicateAddress(),t)},e.prototype.approveAllForMintable=function(t){this.checkForRoot("approveForMintable");return this.approveAll_(this.getAddress_("Main.POSContracts.MintableERC1155PredicateProxy"),t)},e.prototype.deposit=function(t,e){return this.checkForRoot("deposit"),this.depositMany({amounts:[t.amount],tokenIds:[t.tokenId],userAddress:t.userAddress,data:t.data},e)},e.prototype.depositMany=function(t,e){this.checkForRoot("depositMany");var r=t.tokenIds,n=t.amounts,o=t.data,i=t.userAddress,a=N.toHex(0),c=this.client.parent.encodeParameters([r.map((function(t){return N.toHex(t)})),n.map((function(t){return N.toHex(t)})),o||a],["uint256[]","uint256[]","bytes"]);return this.rootChainManager.deposit(i,this.contractParam.address,c,e)},e.prototype.withdrawStart=function(t,e,r){var n=this;return this.checkForChild("withdrawStart"),this.getContract().then((function(o){var i=o.method("withdrawSingle",N.toHex(t),N.toHex(e));return n.processWrite(i,r)}))},e.prototype.withdrawStartMany=function(t,e,r){var n=this;this.checkForChild("withdrawStartMany");var o=t.map((function(t){return N.toHex(t)})),i=e.map((function(t){return N.toHex(t)}));return this.getContract().then((function(t){var e=t.method("withdrawBatch",o,i);return n.processWrite(e,r)}))},e.prototype.withdrawExit=function(t,e){return this.checkForRoot("withdrawExit"),this.withdrawExitPOS(t,o.Erc1155Transfer,!1,e)},e.prototype.withdrawExitFaster=function(t,e){return this.checkForRoot("withdrawExitFaster"),this.withdrawExitPOS(t,o.Erc1155Transfer,!0,e)},e.prototype.withdrawExitMany=function(t,e){return this.checkForRoot("withdrawExitMany"),this.withdrawExitPOS(t,o.Erc1155BatchTransfer,!1,e)},e.prototype.withdrawExitFasterMany=function(t,e){return this.checkForRoot("withdrawExitFasterMany"),this.withdrawExitPOS(t,o.Erc1155BatchTransfer,!0,e)},e.prototype.isWithdrawExited=function(t){return this.isWithdrawn(t,o.Erc1155Transfer)},e.prototype.isWithdrawExitedMany=function(t){return this.isWithdrawn(t,o.Erc1155BatchTransfer)},e.prototype.transfer=function(t,e){return this.transferERC1155(t,e)},e}(Q),lt=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),dt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return lt(e,t),e.prototype.init=function(t){var e=this,r=this.client;return r.init(t).then((function(n){var o=r.mainPOSContracts;r.config=t=Object.assign({rootChainManager:o.RootChainManagerProxy,rootChain:r.mainPlasmaContracts.RootChainProxy},t),e.rootChainManager=new rt(e.client,t.rootChainManager);var i=new st(e.client,t.rootChain);return e.exitUtil=new nt(e.client,i),e}))},e.prototype.erc20=function(t,e){return new $(t,e,this.client,this.getContracts_.bind(this))},e.prototype.erc721=function(t,e){return new ft(t,e,this.client,this.getContracts_.bind(this))},e.prototype.erc1155=function(t,e){return new pt(t,e,this.client,this.getContracts_.bind(this))},e.prototype.depositEther=function(t,e,r){return new $("",!0,this.client,this.getContracts_.bind(this)).depositEther_(t,e,r)},e.prototype.getContracts_=function(){return{exitUtil:this.exitUtil,rootChainManager:this.rootChainManager}},e}(Z),gt={utils:Y,use:l,POSClient:dt},yt="0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff";e.default=gt}]);
//# sourceMappingURL=matic.node.min.js.map